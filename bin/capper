#!/usr/bin/env zsh

# TODO: setup certbot and own cdn domain with digital-ocean:
# https://www.digitalocean.com/community/tutorials/how-to-use-certbot-standalone-mode-to-retrieve-let-s-encrypt-ssl-certificates-on-ubuntu-1804

if [ ! -n "$1" ]; then
  echo "Usage: $0 [file]"
  return
fi

file="$1"
friendly=$(echo "$1" | sed -e "s#$HOME/_screenshots/##g")
s3cmd -P put "$file" s3://caps/screenshots/

if [ "$?" -ne 0 ]; then
  echo "There was a problem uploading '$file' to 's3://caps/screenshots/$friendly'"
else
  echo "https://caps.nyc3.cdn.digitaloceanspaces.com/screenshots/$friendly"
fi
